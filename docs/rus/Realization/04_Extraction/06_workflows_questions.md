# Вопросы: 4.6 Workflows

Примечание (simplified model): Уже соответствовало single-pass; без изменений.

Политика: одноразовый импорт (single-pass), повторных дельт / обновлений не планируется.

| ID | Категория | Вопрос | Статус | Решение |
|----|-----------|--------|--------|---------|
| WQ1 | Instances | Нужно ли переносить активные экземпляры? | closed | A: Нет, переносим только шаблоны (экземпляры пропускаем). |
| WQ2 | Permissions | Нужна ли проверка прав запуска после импорта? | closed | A: Нет отдельной проверки, доверяем on-prem ACL. |
| WQ3 | Versioning | Переносить ли версии шаблонов или только текущую? | closed | A: Только текущая версия. |
| WQ4 | Delta | Нужны ли повторные импорты (дельта)? | closed | A: Нет дельты — один проход. |
| WQ5 | Encoding | Проверить кодировки/языки в шаблонах? | closed | A: Без отдельного сканирования (предполагаем UTF-8). |
|  |  | Пример: test_limit=5 — импорт только 5 шаблонов для smoke без экземпляров. | note |  |

## Решения и последствия
WQ1 (A): Упрощение (не реконструируем состояния), быстрый импорт; потеря незавершённых процессов — требуется ручной рестарт важных цепочек после cutover. Метрика: workflows.instances.skipped.
WQ2 (A): Минимальное время; риск частично «мертвых» шаблонов (если ACL не настроены) — добавить пост-чеклист вручную (audit). Метрика (опционально): workflows.permissions.post_audit_issues.
WQ3 (A): Малый объём, простая схема; теряем историю эволюции шаблонов — если понадобится аудит, потребуется отдельный экспорт из cloud до миграции.
WQ4 (A): Отсутствие механики синхронизации, меньше кода и мониторинга; любые изменения после freeze не попадут — закрепить freeze_time и коммуницировать change freeze владельцам процессов.
WQ5 (A): Нулевая задержка на детекцию; риск скрытых legacy кодировок крайне низок (Bitrix24 отдает UTF-8), при сбое импорт упадёт на валидации — ретрай с ручной правкой.

## Дополнительные заметки
Single-pass гарантирует: не храним diff state, idempotency через source:workflow:tpl:<id> достаточно. Любые запросы «обновить шаблон» после cutover — операционная задача вне миграции.

History:
- scaffold
- decisions applied (WQ1=A,WQ2=A,WQ3=A,WQ4=A,WQ5=A, single-pass policy)
